(function(e){function t(t){for(var c,o,a=t[0],i=t[1],u=t[2],b=0,f=[];b<a.length;b++)o=a[b],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);l&&l(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],c=!0,a=1;a<n.length;a++){var i=n[a];0!==r[i]&&(c=!1)}c&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var c={},r={app:0},s=[];function o(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=c,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)o.d(n,c,function(t){return e[t]}.bind(null,c));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=i;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"16c0":function(e,t,n){"use strict";n.r(t);var c=n("7a23"),r={class:"home-page"};function s(e,t,n,s,o,a){var i=Object(c["x"])("head-box"),u=Object(c["x"])("chat-box");return Object(c["s"])(),Object(c["f"])("div",null,[s.filterList.length>1?(Object(c["s"])(),Object(c["d"])(i,{key:0,"user-id":s.userId,"filter-list":s.filterList},null,8,["user-id","filter-list"])):Object(c["e"])("",!0),Object(c["g"])("div",r,[Object(c["h"])(u,{"now-chat":s.nowChat.obj,"send-message":s.sendMessage},null,8,["now-chat","send-message"])])])}var o=n("6fe0"),a=n("6b0d"),i=n.n(a);const u=i()(o["a"],[["render",s]]);t["default"]=u},"3a33":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var c=n("7a23"),r=n("5502");n("a18c");var s=n("5530");n("d81d"),n("4de4"),n("d3b7"),n("b0c0"),n("4e82");function o(){var e=Object(r["b"])(),t=Object(c["b"])((function(){return e.getters["customList"]})),n=function(n){var c=t.value.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{show:e.where==n||999==n})}));e.dispatch("handFilterList",c)};return{customListChange:n}}var a=o},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23"),r={id:"app"};function s(e,t,n,s,o,a){var i=Object(c["x"])("router-view");return Object(c["s"])(),Object(c["f"])("div",r,[Object(c["g"])("main",null,[Object(c["h"])(i)])])}var o={setup:function(){return Object(c["q"])((function(){})),{}}},a=n("6b0d"),i=n.n(a);const u=i()(o,[["render",s]]);var l=u,b=n("a18c"),f=n("5502"),m=(n("db4d"),{packageVersion:"2022-08-23T12:01:31",backVer:"0",clHandleCall:!0,userId:null,customId:null,customList:[],filterList:[]}),p={handUserId:function(e,t){var n=e.commit;n("getUserId",t)},handCustomList:function(e,t){var n=e.commit;n("getCustomList",t)},handFilterList:function(e,t){var n=e.commit;n("getFilterList",t)}},j={getUserId:function(e,t){e.userId=t},getCustomList:function(e,t){e.customList=t},getFilterList:function(e,t){e.filterList=t}},d={userId:function(e){return e.userId},customList:function(e){return e.customList},filterList:function(e){return e.filterList}},h=Object(f["a"])({state:m,actions:p,mutations:j,getters:d,modules:{}}),O=(n("5b52"),n("8049"),n("1da1")),v=(n("d3b7"),n("96cf"),n("bc3a")),g=n.n(v),y=n("130e");g.a.interceptors.request.use(function(){var e=Object(O["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),g.a.interceptors.response.use((function(e){return e}),(function(e){return Promise.reject(e)})),Object(c["c"])().use(y["a"],g.a),Object(c["c"])(l).config.productionTip=!1,Object(c["c"])(l).use(b["a"]).use(h).mount("#app")},"6fe0":function(e,t,n){"use strict";(function(e){var c=n("5530"),r=(n("ac1f"),n("1276"),n("d81d"),n("d3b7"),n("159b"),n("99af"),n("4e82"),n("5502")),s=(n("a18c"),n("7a23")),o=n("daa8"),a=(n("11c1"),n("7adc")),i=n("c926"),u=(n("3a33"),n("d2c4"));t["a"]={name:"Home",components:{HeadBox:a["a"],ChatBox:i["a"]},setup:function(){var t=Object(r["b"])(),n=(Object(s["u"])({arr:[]}),Object(s["u"])({obj:{}})),a=(Object(s["u"])({val:null}),Object(s["u"])({obj:[]})),i=Object(s["u"])({val:0}),l=Object(s["u"])({val:0}),b=Object(s["v"])("12454687"),f=null,m=Object(s["b"])((function(){return t.getters["userId"]})),p=Object(s["b"])((function(){return t.getters["customList"]})),j=Object(s["b"])((function(){return t.getters["filterList"]}));Object(s["C"])(p,(function(e){console.log("customList",e)}));var d=function(e){var t=h(e.mes.time),c={time:t.getTime,date:t.date,hour:t.hour};e.mes=Object.assign(e.mes,c),console.log("obj??",e),n.obj.chating.push(e.mes);var r=n.obj.chatClient.length-1;if(n.obj.chatClient[r]&&n.obj.chatClient[r].date==e.mes.date){var s=n.obj.chatClient[r].chat.length-1;n.obj.chatClient[r].chat[s].hour==e.mes.hour&&n.obj.chatClient[r].chat[s].chat[0].isUser==e.mes.isUser?n.obj.chatClient[r].chat[s].chat.push(e.mes):n.obj.chatClient[r].chat.push({hour:e.mes.hour,chat:[e.mes]})}else n.obj.chatClient.push({date:e.mes.date,chat:[{hour:e.mes.hour,chat:[e.mes]}]})},h=function(t){var n=e(t).format("YYYY-MM-DDTHH:mm:ss"),c=n.split("Z")[0];return{getTime:e(c).format("YYYY-MM-DDTHH:mm:ss"),date:e(c).format("YYYY-MM-DD"),hour:u["a"].doChatTime(c)}},O=function(e,t){var n=e.split("(emoji)");console.log("mesArr",n);var c="";for(var r in t){var s='<img class="emoji" src="'.concat(t[r],'" alt="emoji"/>');c+=n[r]+s}return c},v=function(e){var t=e.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{chat:[e]})}));console.log("catchArr",t);var n=[];t.forEach((function(e){if(n.some((function(t){return t.date===e.date}))){n.forEach((function(t){t.date===e.date&&(t.chat=t.chat.concat(e.chat))}))}else n.push(e)})),n=n.map((function(e){return{date:e.date,chat:e.chat.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{chat:[e]})}))}}));var r=function(e){var t=[];n[e].chat.forEach((function(e,n){t.some((function(t){return t.hour===e.hour}))&&t.length-1>=0&&t[t.length-1].isUser==e.isUser?t[t.length-1].chat=t[t.length-1].chat.concat(e.chat):t.push(e)})),n[e].chat=t.map((function(e){return{hour:e.hour,chat:e.chat}}))};for(var s in n)r(s);return console.log("result",n),n},g=function(e){var t=e?e.chating.map((function(e){var t=h(e.time);return Object(c["a"])(Object(c["a"])({},e),{},{mes:"text"==e.type&&e.emojis?O(e.mes,e.emojis):e.mes,time:t.getTime,date:t.date,hour:t.hour})})):[],n=t.sort((function(e,t){return e.time>t.time?1:-1})),r=Object(c["a"])(Object(c["a"])({},e),{},{chating:n,chatClient:v(n),show:!0});return r},y=function(){f=Object(o["a"])("http://localhost:4010/"),f&&(console.log("success connect!"),f.emit("getCus",b.value),f.on("haveGetCus",(function(e){console.log("取得客人曾經的訊息",e),e&&(n.obj=g(e[0]))})),f.on("newMessage",(function(e){console.log("有新的訊息進陣列",e),d(e)})),f.on("allDrop",(function(e){a.obj={status:e.status,chatDrop:[{id:0,name:"全部"}].concat(e.chat)},console.log("allDrop.obj",a.obj)})))},w=function(e){console.log("sending new message",e),e.userId=b.value,f.emit("sendMessage",e)},C=function(e,t){console.log(e,t),"chatDrop"==t&&(l.val=e.id,cusShow())};return Object(s["q"])((function(){y()})),{userId:m,allDrop:a,nowStatus:i,nowChat:n,nowChatDrop:l,filterList:j,changeDrop:C,sendMessage:w}}}}).call(this,n("c1df"))},"7adc":function(e,t,n){"use strict";var c=n("7a23"),r={class:"head"},s={class:"hello-three"},o={class:"ham bc-blue"},a={class:"user-box"},i={class:"hi"},u=Object(c["g"])("div",{class:"user"},[Object(c["g"])("i",{class:"fas fa-user"})],-1);function l(e,t,n,l,b,f){return Object(c["s"])(),Object(c["f"])("div",r,[Object(c["g"])("div",s,[(Object(c["s"])(!0),Object(c["f"])(c["a"],null,Object(c["w"])(l.hambur.arr,(function(e){return Object(c["s"])(),Object(c["f"])("div",o)})),256))]),Object(c["g"])("div",a,[Object(c["g"])("div",i,"你好，編號 "+Object(c["z"])(l.props.userId)+" !",1),u])])}var b=n("5530"),f=(n("d81d"),n("99af"),n("5502")),m=n("3a33"),p={name:"HeadBox",components:{},props:{userId:{},filterList:{},clickMenu:{type:Function}},setup:function(e){Object(f["b"])();var t=Object(m["a"])(),n=t.customListChange,r=Object(c["u"])({arr:[1,2,3]}),s=Object(c["u"])({val:999}),o=Object(c["u"])({arr:[{name:"all",id:999,icon:"fas fa-globe"}]});Object(c["C"])((function(){return e.filterList}),(function(e){console.log("ok",e)}));var a=function(e){s.val=e,o.arr=o.arr.map((function(t){return Object(b["a"])(Object(b["a"])({},t),{},{click:t.id==e})})),n(e)},i=function(){o.arr=o.arr.concat(e.filterList),console.log("run",o.arr),a(999)};return Object(c["q"])((function(){console.log("filterList",e.filterList),i()})),{props:e,hambur:r,getWhereId:a,newFilterList:o}}},j=n("6b0d"),d=n.n(j);const h=d()(p,[["render",l]]);t["a"]=h},8049:function(e,t,n){},a18c:function(e,t,n){"use strict";n("d3b7"),n("3ca3"),n("ddb0");var c=n("6c02"),r=n("16c0"),s=[{path:"/",component:r["default"]},{path:"",name:"Home",component:function(){return Promise.resolve().then(n.bind(null,"16c0"))}}],o=Object(c["a"])({history:Object(c["b"])(""),scrollBehavior:function(e,t,n){return{x:0,y:0}},routes:s});t["a"]=o},c926:function(e,t,n){"use strict";var c=n("7a23"),r={class:"chat-page"},s={class:"one-user"},o={class:"chat-date"},a={key:0,class:"user"},i=["src"],u={class:"name"},l={key:0,class:"date"},b={class:"chat-input-box"};function f(e,t,n,f,m,p){var j=Object(c["x"])("chat-type");return Object(c["s"])(),Object(c["f"])("div",r,[Object(c["g"])("div",s,[(Object(c["s"])(!0),Object(c["f"])(c["a"],null,Object(c["w"])(f.props.nowChat.chatClient,(function(e,t){return Object(c["s"])(),Object(c["f"])("div",{class:"li",key:t},[Object(c["g"])("div",o,Object(c["z"])(e.date),1),(Object(c["s"])(!0),Object(c["f"])(c["a"],null,Object(c["w"])(e,(function(e,t){return Object(c["s"])(),Object(c["f"])("div",{key:t},[(Object(c["s"])(!0),Object(c["f"])(c["a"],null,Object(c["w"])(e,(function(e,t){return Object(c["s"])(),Object(c["f"])("div",{class:"chat-min-box",key:t},[(Object(c["s"])(!0),Object(c["f"])(c["a"],null,Object(c["w"])(e.chat,(function(t,n){return Object(c["s"])(),Object(c["f"])("div",{class:"chat-one",key:n},[t.isUser||0!=n?Object(c["e"])("",!0):(Object(c["s"])(),Object(c["f"])("div",a,[Object(c["g"])("img",{class:"cus-img",src:f.userImg,alt:"客服頭像"},null,8,i),Object(c["g"])("div",u,Object(c["z"])(f.userName),1)])),Object(c["g"])("div",{class:Object(c["n"])(["chatting-box",!t.isUser&&"left",t.isUser&&"right"])},[Object(c["h"])(j,{mm:t},null,8,["mm"]),!t.isUser&&n==e.chat.length-1||t.isUser?(Object(c["s"])(),Object(c["f"])("div",l,Object(c["z"])(t.hour),1)):Object(c["e"])("",!0)],2)])})),128))])})),128))])})),128))])})),128))]),Object(c["g"])("div",b,[Object(c["D"])(Object(c["g"])("input",{"onUpdate:modelValue":t[0]||(t[0]=function(e){return f.temp=e}),placeholder:"請輸入訊息",onKeydown:t[1]||(t[1]=Object(c["E"])((function(){return f.sendMessage&&f.sendMessage.apply(f,arguments)}),["enter"]))},null,544),[[c["B"],f.temp]]),Object(c["g"])("button",{onClick:t[2]||(t[2]=function(){return f.sendMessage&&f.sendMessage.apply(f,arguments)})},"送出")])])}var m=n("11c1"),p=(n("99af"),{class:"mes"}),j={key:0,class:"mes-text"},d=["innerHTML"],h=["innerHTML"],O=["src"],v=["src"],g=["src","type"],y=["src"];function w(e,t,n,r,s,o){return Object(c["s"])(),Object(c["f"])("div",p,["text"==r.props.mm.type?(Object(c["s"])(),Object(c["f"])("div",j,[null==r.props.mm.emojis?(Object(c["s"])(),Object(c["f"])("p",{key:0,innerHTML:r.props.mm.mes},null,8,d)):(Object(c["s"])(),Object(c["f"])("p",{key:1,class:"m--10",innerHTML:r.props.mm.mes},null,8,h))])):Object(c["e"])("",!0),"sticker"==r.props.mm.type?(Object(c["s"])(),Object(c["f"])("img",{key:1,class:"sticker",src:r.props.mm.mes,alt:"貼圖",title:"貼圖"},null,8,O)):Object(c["e"])("",!0),"image"==r.props.mm.type?(Object(c["s"])(),Object(c["f"])("img",{key:2,class:"img",src:"".concat(e.apiUrl).concat(r.props.mm.mes,"&type=").concat(r.props.mm.imgType),alt:"圖片",title:"圖片"},null,8,v)):Object(c["e"])("",!0),"video"==r.props.mm.type?(Object(c["s"])(),Object(c["f"])("video",{key:3,width:"320",height:"240",src:"".concat(e.apiUrl).concat(r.props.mm.mes,"&type=").concat(r.props.mm.imgType),type:"video/"+r.props.mm.imgType,autoplay:"",controls:""}," Your browser does not support the video tag. ",8,g)):Object(c["e"])("",!0),"audio"==r.props.mm.type?(Object(c["s"])(),Object(c["f"])("audio",{key:4,src:"".concat(e.apiUrl).concat(r.props.mm.mes,"&type=").concat(r.props.mm.imgType),autoplay:"",controls:""}," Your browser does not support the audio tag. ",8,y)):Object(c["e"])("",!0)])}var C={name:"chatType",components:{},props:{mm:{}},setup:function(e){return Object(c["q"])((function(){})),{props:e}}},L=n("6b0d"),k=n.n(L);const M=k()(C,[["render",w]]);var x=M,I={name:"ChatBox",components:{chatType:x},props:{nowChat:{},sendMessage:{type:Function}},setup:function(e){var t=Object(c["v"])(""),n=Object(c["v"])("https://socket-line-test.herokuapp.com/getImg?name="),r=Object(c["v"])("https://www.129sd.com/uploads/20181113/8f2c2e73d800f2dcb1f63e8afa946876.png"),s=Object(c["v"])("服務員Ａ");Object(c["C"])((function(){return e.nowChat.chatClient}),(function(e){console.log("watch??",e)}),{deep:!0});var o=function(){t.value&&(console.log("當前傳出去給哪個客人的ID",e.nowChat.userId),e.sendMessage({user:!0,mes:t.value,userId:e.nowChat.userId,type:"text",which:3,textId:Object(m["v4"])()}),t.value="")};return Object(c["q"])((function(){})),{props:e,temp:t,apiUrl:n,userImg:r,userName:s,sendMessage:o}}};const T=k()(I,[["render",f]]);t["a"]=T},d2c4:function(e,t,n){"use strict";(function(e){n("ac1f"),n("1276");var c=function(t){var n=t.split("Z")[0],c=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"];if(e(n).format("YYYY-MM-DD")==e(new Date).format("YYYY-MM-DD")){var r="am"==e(n).format("a")?"上午":"下午";return r+" "+e(n).format("hh:mm")}var s=e(n).isoWeekday(),o=c[s-1];return o},r=function(t){var n="am"==e(t).format("a")?"上午":"下午";return n+" "+e(t).format("hh:mm")};t["a"]={doListTime:c,doChatTime:r}}).call(this,n("c1df"))},e42b:function(e,t,n){var c={"./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=s(e);return n(t)}function s(e){if(!n.o(c,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return c[e]}r.keys=function(){return Object.keys(c)},r.resolve=s,e.exports=r,r.id="e42b"}});